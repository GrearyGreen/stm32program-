#include "fun.h"
#include "oled.h"
#include "key.h"
#include "stmflash.h"
#include "delay.h"
#define FLASH_SAVE_ADDR  0X08070000	
#define SIZE sizeof(date)	
	#define SIZE1 sizeof(date1)	
		#define SIZE2 sizeof(date2)	
			#define SIZE3 sizeof(date3)	
				#define SIZE4 sizeof(date4)
#define SIZE5 sizeof(date5)	
#define SIZE6 sizeof(date6)
#define SIZE7 sizeof(date7)
#define SIZE8 sizeof(date8)		
u8 key=0;
u8 flagmode;
u8 func_index=0;
u8 key_run=0,key_mode=0;
int b=1;
float buc=0.01;
extern u16 num;
extern  int kk;
int ss=0;
extern int ii;
extern u16 date[3];
u16 date1[3];
u16 date2[3];
u16 date3[3];
u16 date4[3];
u16 date5[3];
u16 date6[3];
u16 date7[3];
u16 date8[3];
u16 date9[3];
float t0;
float t1;
float t2;
float t3;
float t4;
float t5;
float t6;
float t7;
float t8;
void (*current_operation_index)();

typedef struct
{
	u8 current;//当前状态索引号
	u8 up;//向上翻索引号
	u8 down;//向下翻索引号
	u8 enter;//确认索引号
	void (*current_operation)(void);//函数指针
}key_table;

key_table code_table[13]=
{
    {0,1,1,1,(*fun10)},//第0层，显示Welcomem Use！！！！
    
    {1,4,2,5,(*fun1)},//第一层，显示【测液体温模式】 报警模式  人体测温 学习模式
    {2,1,3,6,(*fun2)},//第一层，显示【测液体温模式  【报警模式  人体测温 学习模式
    {3,2,4,7,(*fun3)},//第一层，显示测温模式，无线模式，【人体测温】,学习模式
    {4,3,1,8,(*fun4)},//第一层，显示测温模式，无线模式，人体测温,【学习模式】

		{5,5,5,1,(*fun5)},//第二层，测温模式 测量液体温度
		{6,6,6,2,(*fun6)},//第二层，  报警模式
		
   {7,7,7,2,(*fun7)},//第二层，    测量人体温度	
		
{8,9,9,10,(*fun8)},//第三层 学习模式界面  液温学习
{9,8,8,11,(*fun9)}, //第三层  学习模式的界面  液温补偿
		
{10,8,8,4,(*fun11)}, //第四层  学习模式的液温学习
		{11,9,9,4,(*fun12)}, //第四层  学习模式的体温学习

	
	
};

unsigned char OLED_buffer1[1024]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xF0,0x00,0x00,0x00,0x00,0x20,0x20,0xE0,0xE0,0x20,0x20,0x00,
0x00,0x00,0x00,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0x00,0x00,0x00,0x00,0xE0,0xA0,0xA0,
0xA0,0xA0,0xA0,0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0x00,0x00,0x00,0x08,0x82,0x70,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x03,0x3C,0xC0,0x00,0x00,0x00,0x00,0x43,0x43,0x60,0x60,0x60,
0x20,0x20,0xA0,0xA2,0xA2,0xB2,0xB2,0xB2,0xB2,0xB0,0xB0,0xB0,0xB0,0xB2,0x32,0x32,
0x32,0xB2,0xB3,0xB0,0xB0,0xB0,0xB3,0xB3,0xB2,0xB2,0xA2,0xA2,0xA0,0x20,0x20,0x60,
0x63,0x60,0x60,0x40,0x40,0x03,0x00,0x00,0x80,0xF0,0x1F,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x0E,0x70,0xC0,0x20,0x80,0x00,0x01,0x03,0x03,
0x07,0x07,0x03,0x01,0x01,0x01,0x01,0x01,0x01,0x03,0x3F,0xFF,0xFF,0xFF,0xFF,0xFE,
0xFF,0xFF,0xFF,0xFF,0xFF,0x0F,0x01,0x01,0x01,0x01,0x01,0x01,0x03,0x07,0x07,0x03,
0x03,0x01,0x00,0x00,0x40,0x80,0xE0,0x3C,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x07,0x1C,0x38,0xE0,0xD0,0x20,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x1F,0xFF,0xFF,0xFF,
0xFF,0xFF,0x7F,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,
0x80,0xC8,0x70,0x3C,0x0E,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,
0x0E,0x1C,0x3A,0x74,0xE8,0xD0,0x80,0x80,0x00,0x80,0x00,0x00,0x00,0x01,0x1F,0xFF,
0x3F,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0xA0,0xD0,0xE0,0x70,0x38,0x1D,0x0E,0x07,
0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x07,0x0E,0x1C,0x1C,0x38,0x38,0x70,0x70,
0x70,0x70,0x38,0x18,0x1C,0x0E,0x06,0x07,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"C:\Users\86139\Desktop\5526b382b5f2365853bed0b1484f21ed.bmp",0*/

};//特斯拉图标
unsigned char OLED_buffer2[1024]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x80,0x80,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x80,
0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x28,0x28,0x44,0x84,0x04,0x00,0x82,
0x82,0x02,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x18,0x00,0x1C,0x00,0x00,0x98,0x00,
0x00,0x01,0x03,0x06,0x84,0x84,0x48,0x68,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x38,0x78,0xC4,0x06,0x02,0x02,0x02,
0x02,0x03,0x83,0xC3,0x42,0x62,0x36,0x1C,0x80,0x80,0xC0,0x40,0x40,0xC0,0x80,0x80,
0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x60,0x10,0x0C,0x07,0x23,0x60,
0x60,0x70,0x30,0x30,0x38,0x38,0x18,0x10,0x00,0x00,0x00,0x00,0x00,0x18,0x1C,0x38,
0x38,0x30,0xFF,0x33,0x70,0x70,0x30,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x38,0x24,
0x54,0x20,0x22,0x22,0x12,0x12,0x02,0x0A,0x12,0x60,0xC3,0x02,0x04,0x34,0xF8,0x00,
0x38,0x3C,0x44,0x46,0x42,0x02,0x02,0x02,0x02,0x82,0x82,0x02,0x01,0x00,0x00,0x00,
0x80,0x42,0x03,0x80,0x00,0x02,0x02,0x01,0x60,0x00,0x90,0x90,0x10,0x10,0x10,0x10,
0x11,0x09,0x0F,0x00,0x00,0xE0,0x38,0x0C,0x03,0x00,0x00,0x00,0x00,0x80,0x70,0x08,
0x04,0x80,0x82,0x00,0x00,0x00,0x40,0x02,0x02,0x04,0x08,0x78,0x04,0x84,0x00,0x02,
0x02,0x00,0x03,0x02,0x04,0x0C,0x78,0x60,0x80,0x00,0x00,0x00,0x00,0xF0,0x18,0x08,
0x04,0x04,0x04,0x04,0x04,0x04,0x0C,0x88,0x78,0x30,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x80,0x80,0x80,0x00,0x40,0x40,0x46,0x7F,0x01,0xA1,0xA1,0xA1,0xA0,0x21,0x21,
0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x0F,0x09,0x19,0x10,0x10,0x10,0x10,0x18,0x0F,
0x04,0x00,0x00,0x07,0x04,0x08,0x08,0x08,0x08,0x08,0x08,0x09,0x07,0x04,0x00,0x00,
0x00,0x00,0xE0,0x3C,0x03,0x00,0x08,0x04,0xFC,0xFC,0xF8,0xF1,0xE1,0xE0,0xE2,0xC8,
0xCA,0xD2,0xD3,0x83,0x80,0x80,0x80,0x80,0x80,0x90,0x88,0x85,0x88,0x91,0x91,0x01,
0x01,0x40,0x50,0x00,0x08,0x1C,0x63,0x83,0x02,0x04,0x04,0x04,0x06,0x03,0x00,0x00,
0x00,0x00,0x00,0x00,0x1E,0x13,0x21,0x20,0x20,0x20,0x20,0x10,0x00,0x08,0x08,0x00,
0x00,0x08,0x04,0x04,0x08,0x08,0x88,0xF0,0x00,0x00,0x00,0x00,0x80,0x80,0xC0,0x4E,
0xDF,0x51,0x30,0x00,0x00,0x00,0x04,0x04,0xFC,0x04,0x04,0x04,0x24,0x86,0xAB,0x38,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x60,0x20,0x00,0x10,
0x10,0x5C,0x87,0x80,0x00,0x00,0x00,0x00,0x01,0x07,0x0F,0x1F,0x1F,0x3F,0x5F,0x5F,
0x5F,0x1F,0x9F,0x9F,0xBF,0x9F,0x9F,0x9F,0x1F,0xFF,0xFF,0xFF,0x7F,0x7F,0x7F,0x78,
0x30,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x01,0x02,0x04,0x08,0x10,0x10,0xC4,0x04,
0x08,0x70,0x00,0x10,0x20,0xE0,0x40,0x40,0x4C,0x42,0x50,0x62,0x62,0x22,0x22,0x22,
0x22,0x02,0x12,0x12,0x11,0x09,0x08,0x0C,0x64,0x9C,0x4E,0x13,0xAD,0x50,0x23,0xA4,
0x48,0x48,0x10,0x90,0x20,0x20,0x20,0x20,0x03,0x12,0x90,0x58,0x3C,0x04,0x05,0x05,
0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x40,0x40,0x40,0x20,0x20,0x20,0x10,0x10,
0x10,0x10,0x10,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x0C,0x17,0x22,0x02,0x04,0x40,
0x08,0x08,0x00,0x00,0x01,0x01,0x02,0x02,0x02,0x04,0x04,0x04,0x00,0x08,0x08,0x08,
0x08,0x00,0x00,0x10,0x10,0x10,0x10,0x50,0x10,0x00,0x08,0x08,0x00,0x00,0x00,0x00,
0x00,0x00,0x04,0x84,0x80,0x10,0x90,0x40,0x6A,0x0A,0x98,0xC9,0x0D,0x57,0x31,0x08,
0x04,0x02,0x08,0x04,0x02,0x01,0x00,0x80,0x00,0x01,0x00,0x00,0x02,0x00,0x00,0x04,
0x04,0x00,0x08,0x08,0x00,0x10,0x10,0x00,0x20,0x00,0x40,0x41,0xC0,0xC2,0x41,0x20,
0x24,0x20,0x10,0x10,0x08,0x08,0x04,0x02,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
0x02,0x02,0x01,0x21,0x21,0x40,0x40,0x80,0x00,0x00,0x00,0x00,0x40,0xA0,0x40,0x00,
0x90,0x20,0x50,0xA0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2C,
0x02,0x00,0x29,0x94,0x92,0x08,0x46,0x41,0x40,0x00,0x00,0x20,0x20,0x00,0x20,0x40,
0x80,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x20,0x00,0xC0,0x00,0x00,
0x00,0x00,0x00,0x40,0x40,0x00,0x00,0x00,0x00,0x08,0x18,0x20,0x40,0x00,0x11,0x31,
0x42,0x12,0x04,0x08,0x18,0x30,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"C:\Users\86139\Desktop\mmexport1597485648763.bmp",0*/
};  //大哥头像
unsigned char OLED_buffer3[1024]={

0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0x0F,0x07,0x03,0x01,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,
0x7F,0x7F,0x7F,0x3F,0x7F,0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,
0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x7F,0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0x7F,0x07,0x03,0x80,0xC1,0x43,0x47,0x47,0xC7,0xCF,0x6F,0x6F,0xC7,0xC7,0xCF,
0xEF,0xEC,0xE3,0xC2,0xE4,0xE4,0xE4,0xE0,0xE0,0xE3,0xE3,0xE3,0xE3,0xE3,0xC3,0xC3,
0xC1,0xC1,0xC1,0xE1,0xE1,0xE1,0xE1,0xE1,0xE1,0xE3,0xC2,0xC2,0xC5,0xC5,0xC5,0x45,
0x05,0x05,0x03,0x03,0x0B,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x01,0x01,0x00,
0x30,0x60,0x60,0x60,0x60,0x70,0x70,0xF0,0xF0,0x70,0x70,0x70,0x70,0x58,0xB8,0xB0,
0xB8,0xB8,0xB8,0xF8,0xF8,0xF8,0xDA,0xDC,0xDC,0xDC,0xCC,0xCC,0xCC,0xCC,0xCC,0xCC,
0xCC,0xCC,0xCC,0xC4,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x80,0x80,0x00,0x01,0x01,
0x01,0x03,0x07,0x0F,0x1F,0xBF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x3F,0x3F,0x1F,
0xFC,0xFC,0x38,0xF8,0xF8,0xF8,0xF8,0x18,0x18,0x18,0x1C,0xDC,0xDE,0x7E,0x3E,0x3E,
0x3F,0x3F,0x3F,0x3F,0x3F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFE,0xBE,0xBE,0x9E,0x8C,0x4C,0x4C,0x7C,0x3C,0x1C,0x1C,0x3C,0x3C,0x0C,0x0C,0xFC,
0xFC,0xF8,0x18,0x18,0x18,0x18,0x38,0xF8,0x88,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
0x08,0xF8,0xF8,0xFC,0xFC,0x04,0x1C,0x1C,0x1C,0x3E,0x26,0x27,0x27,0x27,0x27,0x47,
0x4F,0x5D,0x5E,0x5E,0x7F,0x7F,0xFF,0x7F,0x7F,0x7F,0x7F,0xFF,0xBF,0x2F,0x2F,0x2F,
0x2F,0x6F,0x4F,0xCE,0x8E,0x06,0x0F,0x0F,0x0F,0x0F,0x9F,0xF7,0x66,0x07,0x07,0x07,
0x07,0xF7,0xFF,0xFF,0xFF,0xFF,0xFF,0x3F,0x1F,0x07,0x03,0x01,0x00,0x00,0x18,0xFE,
0x5F,0x5F,0xFE,0xFF,0xFF,0xFF,0x87,0x00,0x00,0x00,0x00,0x03,0x03,0x06,0x04,0xC4,
0xE4,0x84,0x82,0xC2,0xE3,0x81,0x81,0x80,0xE0,0xE0,0x83,0x83,0x81,0x81,0x81,0x81,
0x81,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xFC,0xFF,
0xFF,0x7F,0x40,0x60,0xE0,0xB0,0x98,0x8F,0x8F,0x00,0x00,0x00,0x00,0x40,0xC0,0x80,
0x80,0x3F,0x7F,0x7F,0xFF,0xE0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xF8,0xF0,0xE0,0xE0,0xF8,0x70,0x60,0x60,0x68,
0x78,0x70,0x70,0x70,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x71,0x70,0x30,0x30,0x30,
0x38,0x3F,0x3F,0x3F,0x1F,0x0F,0x00,0x00,0x80,0xC0,0xFC,0x7C,0x46,0x46,0x42,0x43,
0x0C,0x1C,0x1C,0x19,0x0F,0x0F,0x1F,0x7D,0xF1,0xE1,0x81,0x01,0x01,0x01,0x01,0x01,
0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x01,0x01,0x01,0x01,0x01,0x01,
0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x80,0x80,
0xC0,0x40,0x40,0x60,0x20,0xA0,0xA0,0xA0,0xA1,0xB0,0x90,0x90,0x90,0x90,0x10,0x10,
0x10,0x30,0x20,0x20,0x20,0x60,0x40,0x40,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,
0xC0,0xE0,0x60,0x30,0x38,0x1C,0x0E,0x07,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x07,0x0E,0x1C,0x38,0x38,
0x30,0x60,0x60,0xC0,0xC0,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x07,0x03,0x01,0x00,
0x00,0x00,0x03,0x01,0x01,0x09,0x0C,0x04,0x26,0x32,0x12,0x12,0x1A,0x0A,0x0A,0x0A,
0x0A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x80,0x80,0x80,0xC0,0x40,0xE0,0xE0,0xF0,0xF0,0x18,0x1C,0x0C,0x06,0x07,0x03,0x01,
0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x03,0x03,0x06,0x0E,0x1E,0x7E,
0xFC,0xC4,0x04,0x0C,0x0C,0x08,0x08,0x08,0x18,0x18,0x10,0x10,0x10,0x30,0x30,0x20,
0x20,0x20,0x20,0x60,0x60,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0xC0,0xC0,0xC0,0xC0,
0xC0,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x60,0x20,0x20,0x20,0x30,0x30,0x10,0x10,
0x10,0x18,0x18,0x08,0x08,0x0C,0x04,0x04,0x04,0x06,0x06,0x02,0x02,0x03,0x01,0x01,
0x01,0x01,0x00,0x00,0x00,0xFF,0xFF,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"C:\Users\86139\Desktop\7a2623189e809358.bmp",0*/
};

//初始化界面    flagmode = 0
void fun1(void)
{
    flagmode = 0;//初始化模式
	
	OLED_Show16x16(0,0,51,0);
	OLED_Show16x16(16,0,59,0);  //【侧液体温度】
	OLED_Show16x16(32,0,63,0);
	OLED_Show16x16(48,0,62,0);
	OLED_Show16x16(64,0,60,0);
	OLED_Show16x16(80,0,58,0);
	OLED_Show16x16(96,0,52,0);
	
	
	
	OLED_Show16x16(16,2,64,0);  //报警数值
	OLED_Show16x16(32,2,65,0);
	OLED_Show16x16(48,2,66,0);
	OLED_Show16x16(64,2,67,0);
	
	OLED_Show16x16(16,4,61,0);  //人体测温
	OLED_Show16x16(32,4,62,0);
	OLED_Show16x16(48,4,59,0);
	OLED_Show16x16(64,4,60,0);
	

	OLED_Show16x16(16,6,68,0);  //学习模式
	OLED_Show16x16(32,6,69,0);
	OLED_Show16x16(48,6,45,0);
	OLED_Show16x16(64,6,46,0);
GPIO_ResetBits(GPIOA,GPIO_Pin_1);
      GPIO_ResetBits(GPIOA,GPIO_Pin_4);

}

void fun2(void)
{
    flagmode = 0;//初始化模式
	
	OLED_Show16x16(16,0,59,0);  //侧液体温度
	OLED_Show16x16(32,0,63,0);
	OLED_Show16x16(48,0,62,0);
	OLED_Show16x16(64,0,60,0);
	OLED_Show16x16(80,0,58,0);
	
	
	
	OLED_Show16x16(0,2,51,0);
	OLED_Show16x16(16,2,64,0);  //【报警数值】
	OLED_Show16x16(32,2,65,0);
	OLED_Show16x16(48,2,66,0);
	OLED_Show16x16(64,2,67,0);
	OLED_Show16x16(80,2,52,0);
	
		OLED_Show16x16(16,4,61,0);  //人体测温
	OLED_Show16x16(32,4,62,0);
	OLED_Show16x16(48,4,59,0);
	OLED_Show16x16(64,4,60,0);
	

	OLED_Show16x16(16,6,68,0);  //学习模式
	OLED_Show16x16(32,6,69,0);
	OLED_Show16x16(48,6,45,0);
	OLED_Show16x16(64,6,46,0);
GPIO_ResetBits(GPIOA,GPIO_Pin_1);
      GPIO_ResetBits(GPIOA,GPIO_Pin_4);
	
}

void fun3(void)
{
    flagmode = 0;//初始化模式
OLED_Show16x16(16,0,59,0);  //侧液体温度
	OLED_Show16x16(32,0,63,0);
	OLED_Show16x16(48,0,62,0);
	OLED_Show16x16(64,0,60,0);
	OLED_Show16x16(80,0,58,0);
	
	
	
	
	OLED_Show16x16(16,2,64,0);  //报警数值
	OLED_Show16x16(32,2,65,0);
	OLED_Show16x16(48,2,66,0);
	OLED_Show16x16(64,2,67,0);
	
	
	OLED_Show16x16(0,4,51,0);
		OLED_Show16x16(16,4,61,0);  //【人体测温】
	OLED_Show16x16(32,4,62,0);
	OLED_Show16x16(48,4,59,0);
	OLED_Show16x16(64,4,60,0);
		OLED_Show16x16(80,4,52,0);

	OLED_Show16x16(16,6,68,0);  //学习模式
	OLED_Show16x16(32,6,69,0);
	OLED_Show16x16(48,6,45,0);
	OLED_Show16x16(64,6,46,0);
	GPIO_ResetBits(GPIOA,GPIO_Pin_1);
      GPIO_ResetBits(GPIOA,GPIO_Pin_4);
}
void fun4(void)
{
    flagmode = 0;//初始化模式
OLED_Show16x16(16,0,59,0);  //侧液体温度
	OLED_Show16x16(32,0,63,0);
	OLED_Show16x16(48,0,62,0);
	OLED_Show16x16(64,0,60,0);
	OLED_Show16x16(80,0,58,0);
	
	
	
	
	OLED_Show16x16(16,2,64,0);  //报警数值
	OLED_Show16x16(32,2,65,0);
	OLED_Show16x16(48,2,66,0);
	OLED_Show16x16(64,2,67,0);

	
		OLED_Show16x16(16,4,61,0);  //人体测温
	OLED_Show16x16(32,4,62,0);
	OLED_Show16x16(48,4,59,0);
	OLED_Show16x16(64,4,60,0);


    OLED_Show16x16(0,6,51,0);
		OLED_Show16x16(16,6,68,0);  //【学习模式
	OLED_Show16x16(32,6,69,0);
	OLED_Show16x16(48,6,45,0);
	OLED_Show16x16(64,6,46,0);
	OLED_Show16x16(80,6,52,0);
	GPIO_ResetBits(GPIOA,GPIO_Pin_1);
      GPIO_ResetBits(GPIOA,GPIO_Pin_4);

}
///flagmode = 1;

void fun5(void)
{
	flagmode = 1;
	OLED_Show16x16(16,0,59,0);  //【测温模式】  测量液体温度
	OLED_Show16x16(32,0,63,0);
	OLED_Show16x16(48,0,62,0);
	OLED_Show16x16(64,0,60,0);
	OLED_Show16x16(80,0,58,0);
	
  OLED_P6x8Str(0,3,"tempy    :",0);
  OLED_P6x8Str(0,4,"distance:",0);

}

void fun7(void)
{
		flagmode = 1;
		OLED_Show16x16(16,0,59,0);  //【测温模式】 测量人体温度
		OLED_Show16x16(32,0,61,0);
	OLED_Show16x16(48,0,62,0);
	OLED_Show16x16(64,0,60,0);
	OLED_Show16x16(80,0,58,0);
	
  OLED_P6x8Str(0,3,"tempr    :",0);
  OLED_P6x8Str(0,4,"distance:",0);
}


///flagmode = 2;


void fun6(void)
{
	flagmode = 2;
	OLED_Show16x16(16,0,64,0);  //报警模式
	OLED_Show16x16(32,0,65,0);
	OLED_Show16x16(48,0,66,0);
	OLED_Show16x16(64,0,67,0);
    OLED_P8x16Str(0,3,"number",0);
	 Oled_Printf_U16(0,6,num,0);
}




//界面
void fun10(void)
{

	OLED_P6x8Str(0,0,"menu",0);
}


void fun8(void)
{
 OLED_Show16x16(0,0,51,0);
		OLED_Show16x16(16,0,63,0);  //【液温学习
		OLED_Show16x16(32,0,60,0);
	OLED_Show16x16(48,0,68,0);
	OLED_Show16x16(64,0,69,0);
	OLED_Show16x16(80,0,52,0);
	
	OLED_Show16x16(16,2,63,0);  //液温补偿
		OLED_Show16x16(32,2,60,0);
	OLED_Show16x16(48,2,70,0);
	OLED_Show16x16(64,2,71,0);
	
}

void fun9(void)
{

		OLED_Show16x16(16,0,63,0);  //液温学习
		OLED_Show16x16(32,0,60,0);
	OLED_Show16x16(48,0,68,0);
	OLED_Show16x16(64,0,69,0);

	 
	OLED_Show16x16(0,2,51,0);
OLED_Show16x16(16,2,63,0);  //【液温补偿】
		OLED_Show16x16(32,2,60,0);
	OLED_Show16x16(48,2,70,0);
	OLED_Show16x16(64,2,71,0);
	OLED_Show16x16(80,2,52,0);
}

void fun11(void)
{
	flagmode=3;
	OLED_Show16x16(16,0,63,0);  //  液温学习
		OLED_Show16x16(32,0,60,0);
	OLED_Show16x16(48,0,68,0);
	OLED_Show16x16(64,0,69,0);

	
}
void fun12(void)
{
	flagmode=4;
			OLED_Show16x16(16,0,62,0);  // 体温学习
		OLED_Show16x16(32,0,60,0);
	OLED_Show16x16(48,0,68,0);
	OLED_Show16x16(64,0,69,0);
 OLED_P8x16Str(0,3,"buchang",0);
	Oled_Printf_Float(56,3,buc,0);
}




void KeyAction(u8 keycode)
{
    if(keycode == 1)//按下按键KEY0
    {
        func_index = code_table[func_index].up;//功能函数的索引值为数组中的up索引值
        OLED_CLS();//注意每次按下按键才清一次屏
    }
    else if(keycode == 2)//按下按键KEY1
    {
        func_index = code_table[func_index].down;//功能函数的索引值为数组中的down索引值
        OLED_CLS();
    }
    else if(keycode == 3)//按下按键KEY2
    {
        func_index = code_table[func_index].enter;//功能函数的索引值为数组中的enter索引值
        OLED_CLS();
    }
		else if(keycode == 4)//按下按键KEY3  开始测温 液体
    {
        key_run=1;    
			
    }
				else if(keycode == 5)//按下按键   开始测温  人体
    {
        key_run=2;

    }
////学习模式 按下按键5 液体温度存入数组
				else if(keycode == 6)//按下按键KEY5
    {
    }
		
//学习模式  按下按键6 可读存入的数据
				else if(keycode == 7)//按下按键KEY6
    {
			OLED_CLS();
			STMFLASH_Read(FLASH_SAVE_ADDR,(u16*)date,SIZE);
				STMFLASH_Read(FLASH_SAVE_ADDR+20,(u16*)date1,SIZE1);
				STMFLASH_Read(FLASH_SAVE_ADDR+40,(u16*)date2,SIZE2);
				STMFLASH_Read(FLASH_SAVE_ADDR+60,(u16*)date3,SIZE3);
				STMFLASH_Read(FLASH_SAVE_ADDR+80,(u16*)date4,SIZE4);
				STMFLASH_Read(FLASH_SAVE_ADDR+100,(u16*)date5,SIZE5);
				STMFLASH_Read(FLASH_SAVE_ADDR+120,(u16*)date6,SIZE6);
				STMFLASH_Read(FLASH_SAVE_ADDR+140,(u16*)date7,SIZE7);
				STMFLASH_Read(FLASH_SAVE_ADDR+160,(u16*)date8,SIZE8);
			t0=(float)date[0]/100.0;
			t1=(float)date1[0]/100.0;
				t2=(float)date2[0]/100.0;
			t3=(float)date3[0]/100.0;
			t4=(float)date4[0]/100.0;
			t5=(float)date5[0]/100.0;
			t6=(float)date6[0]/100.0;
			t7=(float)date7[0]/100.0;
			t8=(float)date8[0]/100.0;
			
		OLED_P6x8Str(0,4,"READ OK   ",0);
			OLED_CLS();
		delay_ms(100);	
		  Oled_Printf_Float(0,3,t0,0);
Oled_Printf_Float(64,3,t1,0);
Oled_Printf_Float(0,4,t2,0);
Oled_Printf_Float(64,4,t3,0);
Oled_Printf_Float(0,5,t4,0);
Oled_Printf_Float(64,5,t5,0);
Oled_Printf_Float(0,6,t6,0);
Oled_Printf_Float(64,6,t7,0);			
    }
			

		else if(keycode == 8)//按下按键KEY7 
    {
       key_mode=2;;
    }
		
		else if(keycode == 9)//按下按键KEY8 
    {
       key_mode=3;
    }
		
		else if(keycode == 10)//按下按键KEY9 
    {
       
    }
		
		else if(keycode == 11)//按下按键KEY10
    {
       key_mode=4;

    }
}
void display(void)
{
	key=KEY_Scan(0);
	if(key==KEY8_PRES)  //按下按键5  key等于6
			{num++;}
			if(key==KEY9_PRES)  //按下按键6  key等于7
			{num--;}
		if(key==KEY11_PRES)  //按下按键5  key等于6
			{buc=buc+0.01;}
			if(key==KEY12_PRES)  //按下按键6  key等于7
			{buc=buc-0.01;}
			if(key==KEY13_PRES)  //按下按键6  key等于7
			{buc=buc-0.01;}
	KeyAction(key);
	current_operation_index = code_table[func_index].current_operation;
	(*current_operation_index)();//执行当前操作函数
}
